<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ReShade: ReShade API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="main_icon_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ReShade
   </div>
   <div id="projectbrief">A generic post-processing injector for games and video software.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">ReShade API </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_REFERENCE"></a></p>
<p>The ReShade API lets you interact with the resources and rendering commands of applications ReShade was loaded into. It <a href="#events">abstracts</a> away differences between the various graphics API ReShade supports (Direct3D 9/10/11/12, OpenGL and Vulkan), to make it possible to write add-ons that work across a wide range of applications, regardless of the graphics API they use.</p>
<p>A ReShade add-on is a DLL or part of the application that uses the header-only ReShade API to register callbacks for events and do work in those callbacks after they were invoked by ReShade. There are no further requirements, no functions need to be exported and no libraries need to be linked against (although linking against ReShade is supported as well by defining <code>RESHADE_API_LIBRARY</code> before including the headers if so desired). Simply add the <a href="https://github.com/crosire/reshade/tree/main/include">include directory from the ReShade repository</a> to your project and include the <code><a class="el" href="reshade_8hpp.html">reshade.hpp</a></code> header to get started.</p>
<p>An add-on may optionally export an <code>AddonInit</code> function if more complicated one-time initialization than possible in <code>DllMain</code> is required. It will be called by ReShade right after loading the add-on module. </p><div class="fragment"><div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> __declspec(dllexport) <span class="keywordtype">bool</span> AddonInit(HMODULE addon_module, HMODULE reshade_module)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><p> Similarily it may also export an <code>AddonUninit</code> function, which will be called right before unloading (but only if initialization was successfull). </p><div class="fragment"><div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> __declspec(dllexport) <span class="keywordtype">void</span> AddonUninit(HMODULE addon_module, HMODULE reshade_module)</div>
<div class="line">{</div>
<div class="line">}</div>
</div><!-- fragment --><p>Here is a very basic code example of an add-on that registers a callback that gets executed every time a new frame is presented to the screen:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="reshade_8hpp.html">reshade.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> on_present(<a class="code" href="structreshade_1_1api_1_1command__queue.html">reshade::api::command_queue</a> *queue, <a class="code" href="structreshade_1_1api_1_1swapchain.html">reshade::api::swapchain</a> *swapchain, <span class="keyword">const</span> <a class="code" href="structreshade_1_1api_1_1rect.html">reshade::api::rect</a> *source_rect, <span class="keyword">const</span> <a class="code" href="structreshade_1_1api_1_1rect.html">reshade::api::rect</a> *dest_rect, uint32_t dirty_rect_count, <span class="keyword">const</span> <a class="code" href="structreshade_1_1api_1_1rect.html">reshade::api::rect</a> *dirty_rects)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">BOOL WINAPI DllMain(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">switch</span> (fdwReason)</div>
<div class="line">    {</div>
<div class="line">    <span class="keywordflow">case</span> DLL_PROCESS_ATTACH:</div>
<div class="line">        <span class="comment">// Call &#39;reshade::register_addon()&#39; before you call any other function of the ReShade API.</span></div>
<div class="line">        <span class="comment">// This will look for the ReShade instance in the current process and initialize the API when found.</span></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="namespacereshade.html#aabe2def0040846612598f4c26b626013">reshade::register_addon</a>(hinstDLL))</div>
<div class="line">            <span class="keywordflow">return</span> FALSE;</div>
<div class="line">        <span class="comment">// This registers a callback for the &#39;present&#39; event, which occurs every time a new frame is presented to the screen.</span></div>
<div class="line">        <span class="comment">// The function signature has to match the type defined by &#39;reshade::addon_event_traits&lt;reshade::addon_event::present&gt;::decl&#39;.</span></div>
<div class="line">        <span class="comment">// For more details check the inline documentation for each event in &#39;reshade_events.hpp&#39;.</span></div>
<div class="line">        reshade::register_event&lt;reshade::addon_event::present&gt;(&amp;on_present);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> DLL_PROCESS_DETACH:</div>
<div class="line">        <span class="comment">// Optionally unregister the event callback that was previously registered during process attachment again.</span></div>
<div class="line">        reshade::unregister_event&lt;reshade::addon_event::present&gt;(&amp;on_present);</div>
<div class="line">        <span class="comment">// And finally unregister the add-on from ReShade (this will automatically unregister any events and overlays registered by this add-on too).</span></div>
<div class="line">        <a class="code" href="namespacereshade.html#a450eb948a009dd9a8be7fbf3773515c4">reshade::unregister_addon</a>(hinstDLL);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> TRUE;</div>
<div class="line">}</div>
<div class="ttc" id="anamespacereshade_html_a450eb948a009dd9a8be7fbf3773515c4"><div class="ttname"><a href="namespacereshade.html#a450eb948a009dd9a8be7fbf3773515c4">reshade::unregister_addon</a></div><div class="ttdeci">void unregister_addon(HMODULE addon_module, [[maybe_unused]] HMODULE reshade_module=nullptr)</div><div class="ttdoc">Unregisters this module as an add-on. Call this in 'AddonUninit' or 'DllMain' during process detach,...</div><div class="ttdef"><b>Definition:</b> reshade.hpp:263</div></div>
<div class="ttc" id="anamespacereshade_html_aabe2def0040846612598f4c26b626013"><div class="ttname"><a href="namespacereshade.html#aabe2def0040846612598f4c26b626013">reshade::register_addon</a></div><div class="ttdeci">bool register_addon(HMODULE addon_module, [[maybe_unused]] HMODULE reshade_module=nullptr)</div><div class="ttdoc">Registers this module as an add-on with ReShade. Call this in 'AddonInit' or 'DllMain' during process...</div><div class="ttdef"><b>Definition:</b> reshade.hpp:229</div></div>
<div class="ttc" id="areshade_8hpp_html"><div class="ttname"><a href="reshade_8hpp.html">reshade.hpp</a></div></div>
<div class="ttc" id="astructreshade_1_1api_1_1command__queue_html"><div class="ttname"><a href="structreshade_1_1api_1_1command__queue.html">reshade::api::command_queue</a></div><div class="ttdoc">A command queue, used to execute command lists on the GPU.</div><div class="ttdef"><b>Definition:</b> reshade_api_device.hpp:1123</div></div>
<div class="ttc" id="astructreshade_1_1api_1_1rect_html"><div class="ttname"><a href="structreshade_1_1api_1_1rect.html">reshade::api::rect</a></div><div class="ttdoc">Describes a rectangle.</div><div class="ttdef"><b>Definition:</b> reshade_api_pipeline.hpp:1209</div></div>
<div class="ttc" id="astructreshade_1_1api_1_1swapchain_html"><div class="ttname"><a href="structreshade_1_1api_1_1swapchain.html">reshade::api::swapchain</a></div><div class="ttdoc">A swap chain, used to present images to the screen.</div><div class="ttdef"><b>Definition:</b> reshade_api_device.hpp:1219</div></div>
</div><!-- fragment --><p>After building an add-on DLL, change its file extension from <code>.dll</code> to <code>.addon</code> and put it into the add-on search directory configured in ReShade (which defaults to the same directory as ReShade). It will be picked up and loaded automatically on the next launch of the application.</p>
<p>For more complex examples, see the <a href="https://github.com/crosire/reshade/tree/main/examples">examples directory in the repository</a>.</p>
<h1><a class="anchor" id="autotoc_md0"></a>
Events</h1>
<p>The graphics API abstraction is modeled after the Direct3D 12 and Vulkan APIs, so much of the terminology used should be familiar to developers that have used those before.</p>
<p>Detailed inline documentation for all classes and methods can be found inside the headers (see <code><a class="el" href="reshade__api__device_8hpp.html">reshade_api_device.hpp</a></code> for the abstraction object classes and <code><a class="el" href="reshade__events_8hpp.html">reshade_events.hpp</a></code> for a list of available events).</p>
<p>The base object everything else is created from is a <code><a class="el" href="structreshade_1_1api_1_1device.html" title="A logical render device, used for resource creation and global operations.">reshade::api::device</a></code>. This represents a logical rendering device that is typically mapped to a physical GPU (but may also be mapped to multiple GPUs). ReShade will call the <code><a class="el" href="namespacereshade.html#a1187cd7f6d411c0a2dc648203c7d923aa0ce4a4653b06410e17282af7873d5937" title="Called after successful device creation, from: IDirect3D9::CreateDevice IDirect3D9Ex::CreateDeviceEx ...">reshade::addon_event::init_device</a></code> event after the application created a device, which can e.g. be used to do some initialization work that only has to happen once. The <code><a class="el" href="namespacereshade.html#a1187cd7f6d411c0a2dc648203c7d923aadd51261dc8f39fc42b6e7f9029eedc02" title="Called on device destruction, before: IDirect3DDevice9::Reset IDirect3DDevice9Ex::ResetEx IDirect3DDe...">reshade::addon_event::destroy_device</a></code> event is called before this device is destroyed again, which can be used to perform clean up work. </p><div class="fragment"><div class="line"><span class="comment">// Example callback function that can be registered via &#39;reshade::register_event&lt;reshade::addon_event::init_device&gt;(&amp;on_init_device)&#39;.</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> on_init_device(<a class="code" href="structreshade_1_1api_1_1device.html">reshade::api::device</a> *device)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// In case one wants to do something with the native graphics API object, rather than doing all work</span></div>
<div class="line">    <span class="comment">// through the ReShade API, can retrieve it as follows:</span></div>
<div class="line">    <span class="keywordflow">if</span> (device-&gt;<a class="code" href="structreshade_1_1api_1_1device.html#a3bfebff854ca583bada18e861c377b9f">get_api</a>() == <a class="code" href="namespacereshade_1_1api.html#a0e2758bd8e3478f957852a26e12d7f5fa6590a43543d53241ebf77667ac85f2a7">reshade::api::device_api::d3d11</a>)</div>
<div class="line">    {</div>
<div class="line">        ID3D11Device *<span class="keyword">const</span> d3d11_device = (ID3D11Device *)device-&gt;<a class="code" href="structreshade_1_1api_1_1api__object.html#a4541f0b58f80f16dc6729858e42175a7">get_native</a>();</div>
<div class="line">        <span class="comment">// ...</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// But preferably things should be done through the graphics API abstraction.</span></div>
<div class="line">    <span class="comment">// E.g. to create a new 800x600 texture in GPU memory, call &#39;reshade::api::device::create_resource()&#39; like this:</span></div>
<div class="line">    <a class="code" href="structreshade_1_1api_1_1resource.html">reshade::api::resource</a> texture = {};</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structreshade_1_1api_1_1resource__desc.html">reshade::api::resource_desc</a> desc(</div>
<div class="line">        800, 600, 1, 1,</div>
<div class="line">        <a class="code" href="namespacereshade_1_1api.html#adbd317502610c902e7097163f5a9bb89a165761d8df0cf06f59f2db7b2445d833">reshade::api::format::r8g8b8a8_unorm</a>,</div>
<div class="line">        1,</div>
<div class="line">        <a class="code" href="namespacereshade_1_1api.html#a5281da0286a1680c9dec5a6109871daaaf08840c4dc862fadbc7c358ab58a6ed9">reshade::api::memory_heap::gpu_only</a>,</div>
<div class="line">        <a class="code" href="namespacereshade_1_1api.html#af7c77e737cfeb069db2fa6f72f35b059aa24632445528325a6af3096b89d7e043">reshade::api::resource_usage::shader_resource</a> | <a class="code" href="namespacereshade_1_1api.html#af7c77e737cfeb069db2fa6f72f35b059ad45c5bd809b1fc46e5f3a29c44acde8d">reshade::api::resource_usage::render_target</a>);</div>
<div class="line">    <span class="keywordflow">if</span> (!device-&gt;<a class="code" href="structreshade_1_1api_1_1device.html#aabf1752bd0c35e3eb0a603f8d9adaa2a">create_resource</a>(desc, <span class="keyword">nullptr</span>, <a class="code" href="namespacereshade_1_1api.html#af7c77e737cfeb069db2fa6f72f35b059a5e543256c480ac577d30f76f9120eb74">reshade::api::resource_usage::undefined</a>, &amp;texture))</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Error handling ...</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">}</div>
<div class="ttc" id="anamespacereshade_1_1api_html_a0e2758bd8e3478f957852a26e12d7f5fa6590a43543d53241ebf77667ac85f2a7"><div class="ttname"><a href="namespacereshade_1_1api.html#a0e2758bd8e3478f957852a26e12d7f5fa6590a43543d53241ebf77667ac85f2a7">reshade::api::device_api::d3d11</a></div><div class="ttdeci">@ d3d11</div><div class="ttdoc">Direct3D 11</div></div>
<div class="ttc" id="anamespacereshade_1_1api_html_a5281da0286a1680c9dec5a6109871daaaf08840c4dc862fadbc7c358ab58a6ed9"><div class="ttname"><a href="namespacereshade_1_1api.html#a5281da0286a1680c9dec5a6109871daaaf08840c4dc862fadbc7c358ab58a6ed9">reshade::api::memory_heap::gpu_only</a></div><div class="ttdeci">@ gpu_only</div></div>
<div class="ttc" id="anamespacereshade_1_1api_html_adbd317502610c902e7097163f5a9bb89a165761d8df0cf06f59f2db7b2445d833"><div class="ttname"><a href="namespacereshade_1_1api.html#adbd317502610c902e7097163f5a9bb89a165761d8df0cf06f59f2db7b2445d833">reshade::api::format::r8g8b8a8_unorm</a></div><div class="ttdeci">@ r8g8b8a8_unorm</div></div>
<div class="ttc" id="anamespacereshade_1_1api_html_af7c77e737cfeb069db2fa6f72f35b059a5e543256c480ac577d30f76f9120eb74"><div class="ttname"><a href="namespacereshade_1_1api.html#af7c77e737cfeb069db2fa6f72f35b059a5e543256c480ac577d30f76f9120eb74">reshade::api::resource_usage::undefined</a></div><div class="ttdeci">@ undefined</div></div>
<div class="ttc" id="anamespacereshade_1_1api_html_af7c77e737cfeb069db2fa6f72f35b059aa24632445528325a6af3096b89d7e043"><div class="ttname"><a href="namespacereshade_1_1api.html#af7c77e737cfeb069db2fa6f72f35b059aa24632445528325a6af3096b89d7e043">reshade::api::resource_usage::shader_resource</a></div><div class="ttdeci">@ shader_resource</div></div>
<div class="ttc" id="anamespacereshade_1_1api_html_af7c77e737cfeb069db2fa6f72f35b059ad45c5bd809b1fc46e5f3a29c44acde8d"><div class="ttname"><a href="namespacereshade_1_1api.html#af7c77e737cfeb069db2fa6f72f35b059ad45c5bd809b1fc46e5f3a29c44acde8d">reshade::api::resource_usage::render_target</a></div><div class="ttdeci">@ render_target</div></div>
<div class="ttc" id="astructreshade_1_1api_1_1api__object_html_a4541f0b58f80f16dc6729858e42175a7"><div class="ttname"><a href="structreshade_1_1api_1_1api__object.html#a4541f0b58f80f16dc6729858e42175a7">reshade::api::api_object::get_native</a></div><div class="ttdeci">virtual uint64_t get_native() const =0</div><div class="ttdoc">Gets the underlying native object for this API object.</div></div>
<div class="ttc" id="astructreshade_1_1api_1_1device_html"><div class="ttname"><a href="structreshade_1_1api_1_1device.html">reshade::api::device</a></div><div class="ttdoc">A logical render device, used for resource creation and global operations.</div><div class="ttdef"><b>Definition:</b> reshade_api_device.hpp:303</div></div>
<div class="ttc" id="astructreshade_1_1api_1_1device_html_a3bfebff854ca583bada18e861c377b9f"><div class="ttname"><a href="structreshade_1_1api_1_1device.html#a3bfebff854ca583bada18e861c377b9f">reshade::api::device::get_api</a></div><div class="ttdeci">virtual device_api get_api() const =0</div><div class="ttdoc">Gets the underlying graphics API used by this device.</div></div>
<div class="ttc" id="astructreshade_1_1api_1_1device_html_aabf1752bd0c35e3eb0a603f8d9adaa2a"><div class="ttname"><a href="structreshade_1_1api_1_1device.html#aabf1752bd0c35e3eb0a603f8d9adaa2a">reshade::api::device::create_resource</a></div><div class="ttdeci">virtual bool create_resource(const resource_desc &amp;desc, const subresource_data *initial_data, resource_usage initial_state, resource *out_handle, void **shared_handle=nullptr)=0</div><div class="ttdoc">Allocates and creates a new resource.</div></div>
<div class="ttc" id="astructreshade_1_1api_1_1resource__desc_html"><div class="ttname"><a href="structreshade_1_1api_1_1resource__desc.html">reshade::api::resource_desc</a></div><div class="ttdoc">Describes a resource, such as a buffer or texture.</div><div class="ttdef"><b>Definition:</b> reshade_api_resource.hpp:236</div></div>
<div class="ttc" id="astructreshade_1_1api_1_1resource_html"><div class="ttname"><a href="structreshade_1_1api_1_1resource.html">reshade::api::resource</a></div><div class="ttdoc">An opaque handle to a resource object (buffer, texture, ...).</div><div class="ttdef"><b>Definition:</b> reshade_api_resource.hpp:320</div></div>
</div><!-- fragment --><p>To execute rendering commands, an application has to record them into a <code><a class="el" href="structreshade_1_1api_1_1command__list.html" title="A command list, used to enqueue render commands on the CPU, before later executing them in a command ...">reshade::api::command_list</a></code> and then submit to a <code><a class="el" href="structreshade_1_1api_1_1command__queue.html" title="A command queue, used to execute command lists on the GPU.">reshade::api::command_queue</a></code>. In some graphics APIs there is only a single implicit command list and queue, but modern ones like Direct3D 12 and Vulkan allow the creation of multiple for more efficient multi-threaded rendering. ReShade will call the <code><a class="el" href="namespacereshade.html#a1187cd7f6d411c0a2dc648203c7d923aa55c3115ed47da6152333a6c73cf95b6c" title="Called after successful command list creation, from: ID3D11Device::CreateDeferredContext ID3D11Device...">reshade::addon_event::init_command_list</a></code> and <code><a class="el" href="namespacereshade.html#a1187cd7f6d411c0a2dc648203c7d923aa683d20275692dd0dfb59bc9605f74ca5" title="Called after successful command queue creation, from: ID3D12Device::CreateCommandQueue vkCreateDevice...">reshade::addon_event::init_command_queue</a></code> events after any such object was created by the application (including the implicit ones for older graphics APIs). Similarily, <code><a class="el" href="namespacereshade.html#a1187cd7f6d411c0a2dc648203c7d923aa27f5880d5225af672f41edbd185afbbc" title="Called on command list destruction, before: ID3D11CommandList::Release ID3D12CommandList::Release vkF...">reshade::addon_event::destroy_command_list</a></code> and <code><a class="el" href="namespacereshade.html#a1187cd7f6d411c0a2dc648203c7d923aa870eb83f45b606557b666ff9b4081261" title="Called on command queue destruction, before: ID3D12CommandQueue::Release vkDestroyDevice (for every q...">reshade::addon_event::destroy_command_queue</a></code> are called upon their destruction.</p>
<p>ReShade will also pass the current command list object to every command event, like <code><a class="el" href="namespacereshade.html#a1187cd7f6d411c0a2dc648203c7d923aa817491bc777731f0f0c6e485f28e4d86" title="Called before: IDirect3DDevice9::DrawPrimitive IDirect3DDevice9::DrawPrimitiveUP IDirect3DDevice9::Pr...">reshade::addon_event::draw</a></code>, <code><a class="el" href="namespacereshade.html#a1187cd7f6d411c0a2dc648203c7d923aa9dddf2a4f7d94594ec2ea98407a410e1" title="Called before: ID3D11DeviceContext::Dispatch ID3D12GraphicsCommandList::Dispatch glDispatchCompute vk...">reshade::addon_event::dispatch</a></code> and so on, which can be used to add additional commands to that command list or replace those of the application. </p><div class="fragment"><div class="line"><span class="comment">// Example callback function that can be registered via &#39;reshade::register_event&lt;reshade::addon_event::draw&gt;(&amp;on_draw)&#39;.</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">bool</span> on_draw(<a class="code" href="structreshade_1_1api_1_1command__list.html">reshade::api::command_list</a> *cmd_list, uint32_t vertices, uint32_t instances, uint32_t first_vertex, uint32_t first_instance)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Clear a render target to red before every time a single triangle is drawn</span></div>
<div class="line">    <span class="keywordflow">if</span> (vertices == 3 &amp;&amp; instances == 1)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="structreshade_1_1api_1_1resource__view.html">reshade::api::resource_view</a> rtv = ...;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">float</span> clear_color[4] = { 1.0f, 0.0f, 0.0f, 1.0f };</div>
<div class="line">        cmd_list-&gt;<a class="code" href="structreshade_1_1api_1_1command__list.html#a45c49db5bbfa3f9d2af9fc2104df088f">clear_render_target_view</a>(rtv, clear_color);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Return &#39;true&#39; to prevent this application command from actually being executed (e.g. because already having added a new command via &#39;cmd_list-&gt;draw(...)&#39; or similar that should replace it).</span></div>
<div class="line">    <span class="comment">// Return &#39;false&#39; to leave it unaffected.</span></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">}</div>
<div class="ttc" id="astructreshade_1_1api_1_1command__list_html"><div class="ttname"><a href="structreshade_1_1api_1_1command__list.html">reshade::api::command_list</a></div><div class="ttdoc">A command list, used to enqueue render commands on the CPU, before later executing them in a command ...</div><div class="ttdef"><b>Definition:</b> reshade_api_device.hpp:656</div></div>
<div class="ttc" id="astructreshade_1_1api_1_1command__list_html_a45c49db5bbfa3f9d2af9fc2104df088f"><div class="ttname"><a href="structreshade_1_1api_1_1command__list.html#a45c49db5bbfa3f9d2af9fc2104df088f">reshade::api::command_list::clear_render_target_view</a></div><div class="ttdeci">virtual void clear_render_target_view(resource_view rtv, const float color[4], uint32_t rect_count=0, const rect *rects=nullptr)=0</div><div class="ttdoc">Clears the resource referenced by the render target view.</div></div>
<div class="ttc" id="astructreshade_1_1api_1_1resource__view_html"><div class="ttname"><a href="structreshade_1_1api_1_1resource__view.html">reshade::api::resource_view</a></div><div class="ttdoc">An opaque handle to a resource view object (depth-stencil, render target, shader resource view,...</div><div class="ttdef"><b>Definition:</b> reshade_api_resource.hpp:416</div></div>
</div><!-- fragment --><p>Showing results on the screen is done through a <code><a class="el" href="structreshade_1_1api_1_1swapchain.html" title="A swap chain, used to present images to the screen.">reshade::api::swapchain</a></code> object. This is a collection of back buffers that the application can render into, which will eventually be presented to the screen. There may be multiple swap chains, if for example the application is rendering to multiple windows, or to a screen and a VR headset. ReShade again will call the <code><a class="el" href="namespacereshade.html#a1187cd7f6d411c0a2dc648203c7d923aa4b363e79a26e541736e9c156dd549ab7" title="Called after successful swap chain creation, from: IDirect3D9::CreateDevice (for the implicit swap ch...">reshade::addon_event::init_swapchain</a></code> event after such an object was created by the application (and <code><a class="el" href="namespacereshade.html#a1187cd7f6d411c0a2dc648203c7d923aa1b7f8bf06b1ea8362e57087e54bf7af9" title="Called on swap chain destruction, before: IDirect3DDevice9::Release (for the implicit swap chain) IDi...">reshade::addon_event::destroy_swapchain</a></code> on destruction). In addition ReShade will call the <code><a class="el" href="namespacereshade.html#a1187cd7f6d411c0a2dc648203c7d923aae1e39784d890e8fce9d5deafaff9b641" title="Called on swap chain creation, before: IDirect3D9::CreateDevice (for the implicit swap chain) IDirect...">reshade::addon_event::create_swapchain</a></code> event before a swap chain is created, so an add-on may modify its description before that happens. For example, to force the resolution to a specific value, one can do the following: </p><div class="fragment"><div class="line"><span class="comment">// Example callback function that can be registered via &#39;reshade::register_event&lt;reshade::addon_event::create_swapchain&gt;(&amp;on_create_swapchain)&#39;.</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">bool</span> on_create_swapchain(<a class="code" href="structreshade_1_1api_1_1swapchain__desc.html">reshade::api::swapchain_desc</a> &amp;desc, <span class="keywordtype">void</span> *hwnd)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Change resolution to 1920x1080 if the application is trying to create a swap chain at 800x600.</span></div>
<div class="line">    <span class="keywordflow">if</span> (desc.<a class="code" href="structreshade_1_1api_1_1swapchain__desc.html#afd5ea8863292c27cd475ae7dfa423319">back_buffer</a>.<a class="code" href="structreshade_1_1api_1_1resource__desc.html#a6bb6674a74e25365deee718c1312eaf4">texture</a>.width == 800 &amp;&amp;</div>
<div class="line">        desc.<a class="code" href="structreshade_1_1api_1_1swapchain__desc.html#afd5ea8863292c27cd475ae7dfa423319">back_buffer</a>.<a class="code" href="structreshade_1_1api_1_1resource__desc.html#a6bb6674a74e25365deee718c1312eaf4">texture</a>.height == 600)</div>
<div class="line">    {</div>
<div class="line">        desc.<a class="code" href="structreshade_1_1api_1_1swapchain__desc.html#afd5ea8863292c27cd475ae7dfa423319">back_buffer</a>.<a class="code" href="structreshade_1_1api_1_1resource__desc.html#a6bb6674a74e25365deee718c1312eaf4">texture</a>.width = 1920;</div>
<div class="line">        desc.<a class="code" href="structreshade_1_1api_1_1swapchain__desc.html#afd5ea8863292c27cd475ae7dfa423319">back_buffer</a>.<a class="code" href="structreshade_1_1api_1_1resource__desc.html#a6bb6674a74e25365deee718c1312eaf4">texture</a>.height = 1080;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Return &#39;true&#39; for ReShade to overwrite the swap chain description of the application with the values set in this callback.</span></div>
<div class="line">    <span class="comment">// Return &#39;false&#39; to leave it unaffected.</span></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="ttc" id="astructreshade_1_1api_1_1resource__desc_html_a6bb6674a74e25365deee718c1312eaf4"><div class="ttname"><a href="structreshade_1_1api_1_1resource__desc.html#a6bb6674a74e25365deee718c1312eaf4">reshade::api::resource_desc::texture</a></div><div class="ttdeci">struct reshade::api::resource_desc::@9::@12 texture</div><div class="ttdoc">Used when resource type is a texture or surface.</div></div>
<div class="ttc" id="astructreshade_1_1api_1_1swapchain__desc_html"><div class="ttname"><a href="structreshade_1_1api_1_1swapchain__desc.html">reshade::api::swapchain_desc</a></div><div class="ttdoc">Describes a swap chain and its back buffer resources.</div><div class="ttdef"><b>Definition:</b> reshade_api_device.hpp:1190</div></div>
<div class="ttc" id="astructreshade_1_1api_1_1swapchain__desc_html_afd5ea8863292c27cd475ae7dfa423319"><div class="ttname"><a href="structreshade_1_1api_1_1swapchain__desc.html#afd5ea8863292c27cd475ae7dfa423319">reshade::api::swapchain_desc::back_buffer</a></div><div class="ttdeci">resource_desc back_buffer</div><div class="ttdoc">Description of the back buffer resources.</div><div class="ttdef"><b>Definition:</b> reshade_api_device.hpp:1194</div></div>
</div><!-- fragment --><p>ReShade associates an independent post-processing effect runtime with most swap chains. This is the runtime one usually controls via the ReShade overlay, but it can also be controlled programatically via the ReShade API using methods of the <code><a class="el" href="structreshade_1_1api_1_1effect__runtime.html" title="A post-processing effect runtime, used to control effects.">reshade::api::effect_runtime</a></code> object.</p>
<p>In contrast to the described basic API abstraction objects, any buffers, textures, pipelines, etc. are referenced via handles. These are either created by the application and passed to events (like <code><a class="el" href="namespacereshade.html#a1187cd7f6d411c0a2dc648203c7d923aadd7d9b749851d7426e74a16390eaeec8" title="Called after successful resource creation from: IDirect3DDevice9::CreateVertexBuffer IDirect3DDevice9...">reshade::addon_event::init_resource</a></code>, <code><a class="el" href="namespacereshade.html#a1187cd7f6d411c0a2dc648203c7d923aa21182f9a819ec7d8be03b99c155f8be0" title="Called after successful pipeline creation from: IDirect3DDevice9::CreateVertexShader IDirect3DDevice9...">reshade::addon_event::init_pipeline</a></code>, ...) or can be created through the <code><a class="el" href="structreshade_1_1api_1_1device.html" title="A logical render device, used for resource creation and global operations.">reshade::api::device</a></code> object of the ReShade API (via <code><a class="el" href="structreshade_1_1api_1_1device.html#aabf1752bd0c35e3eb0a603f8d9adaa2a" title="Allocates and creates a new resource.">reshade::api::device::create_resource()</a></code>, <code><a class="el" href="structreshade_1_1api_1_1device.html#af4b7e653153a8c04faa02dd078ad8791" title="Creates a new pipeline state object.">reshade::api::device::create_pipeline()</a></code>, ...).</p>
<p>Buffers and textures are referenced via <code><a class="el" href="structreshade_1_1api_1_1resource.html" title="An opaque handle to a resource object (buffer, texture, ...).">reshade::api::resource</a></code> handles. Depth-stencil, render target, shader resource or unordered access views to such resources are referenced via <code><a class="el" href="structreshade_1_1api_1_1resource__view.html" title="An opaque handle to a resource view object (depth-stencil, render target, shader resource view,...">reshade::api::resource_view</a></code> handles. Sampler state objects are referenced via <code><a class="el" href="structreshade_1_1api_1_1sampler.html" title="An opaque handle to a sampler state object.">reshade::api::sampler</a></code> handles, (partial) pipeline state objects via <code><a class="el" href="structreshade_1_1api_1_1pipeline.html" title="An opaque handle to a pipeline state object.">reshade::api::pipeline</a></code> handles and so on.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Overlays</h1>
<p>It is also supported to add an overlay, which can e.g. be used to display debug information or interact with the user in-application. Overlays are created with the use of the docking branch of <a href="https://github.com/ocornut/imgui/tree/v1.90-docking">Dear ImGui</a>. Including <code><a class="el" href="reshade_8hpp.html">reshade.hpp</a></code> after <a href="https://github.com/ocornut/imgui/blob/v1.90-docking/imgui.h"><code>imgui.h</code></a> will automatically overwrite all Dear ImGui functions to use the instance created and managed by ReShade. This means all you have to do is include these two headers and use Dear ImGui as usual (without having to build its source code files):</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define IMGUI_DISABLE_INCLUDE_IMCONFIG_H</span></div>
<div class="line"><span class="preprocessor">#define ImTextureID ImU64 </span><span class="comment">// Change ImGui texture ID type to that of a &#39;reshade::api::resource_view&#39; handle</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;imgui.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="reshade_8hpp.html">reshade.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">bool</span> g_popup_window_visible = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> draw_debug_overlay(<a class="code" href="structreshade_1_1api_1_1effect__runtime.html">reshade::api::effect_runtime</a> *runtime)</div>
<div class="line">{</div>
<div class="line">    ImGui::TextUnformatted(<span class="stringliteral">&quot;Some text&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ImGui::Button(<span class="stringliteral">&quot;Press me to open an additional popup window&quot;</span>))</div>
<div class="line">        g_popup_window_visible = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (g_popup_window_visible)</div>
<div class="line">    {</div>
<div class="line">        ImGui::Begin(<span class="stringliteral">&quot;Popup&quot;</span>, &amp;g_popup_window_visible);</div>
<div class="line">        ImGui::TextUnformatted(<span class="stringliteral">&quot;Some other text&quot;</span>);</div>
<div class="line">        ImGui::End();</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> draw_settings_overlay(<a class="code" href="structreshade_1_1api_1_1effect__runtime.html">reshade::api::effect_runtime</a> *runtime)</div>
<div class="line">{</div>
<div class="line">    ImGui::Checkbox(<span class="stringliteral">&quot;Popup window is visible&quot;</span>, &amp;g_popup_window_visible);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">BOOL WINAPI DllMain(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">switch</span> (fdwReason)</div>
<div class="line">    {</div>
<div class="line">    <span class="keywordflow">case</span> DLL_PROCESS_ATTACH:</div>
<div class="line">        <span class="comment">// This will also populate the Dear ImGui function table.</span></div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code" href="namespacereshade.html#aabe2def0040846612598f4c26b626013">reshade::register_addon</a>(hinstDLL))</div>
<div class="line">            <span class="keywordflow">return</span> FALSE;</div>
<div class="line">        <span class="comment">// This registers a new overlay with the specified name with ReShade.</span></div>
<div class="line">        <span class="comment">// It will be displayed as an additional window when the ReShade overlay is opened.</span></div>
<div class="line">        <span class="comment">// Its contents are defined by Dear ImGui commands issued in the specified callback function.</span></div>
<div class="line">        <a class="code" href="namespacereshade.html#ada303de977b98d78a41a898182b54cb0">reshade::register_overlay</a>(<span class="stringliteral">&quot;Test&quot;</span>, &amp;draw_debug_overlay);</div>
<div class="line">        <span class="comment">// It is also possible to register a special settings overlay by passing &#39;nullptr&#39; instead of a title.</span></div>
<div class="line">        <span class="comment">// This is shown beneath the add-on information in the add-on list of the ReShade overlay and can be used to present settings to users.</span></div>
<div class="line">        <a class="code" href="namespacereshade.html#ada303de977b98d78a41a898182b54cb0">reshade::register_overlay</a>(<span class="keyword">nullptr</span>, &amp;draw_settings_overlay);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> DLL_PROCESS_DETACH:</div>
<div class="line">        <a class="code" href="namespacereshade.html#a450eb948a009dd9a8be7fbf3773515c4">reshade::unregister_addon</a>(hinstDLL);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> TRUE;</div>
<div class="line">}</div>
<div class="ttc" id="anamespacereshade_html_ada303de977b98d78a41a898182b54cb0"><div class="ttname"><a href="namespacereshade.html#ada303de977b98d78a41a898182b54cb0">reshade::register_overlay</a></div><div class="ttdeci">void register_overlay(const char *title, void(*callback)(api::effect_runtime *runtime))</div><div class="ttdoc">Registers an overlay with ReShade.</div><div class="ttdef"><b>Definition:</b> reshade.hpp:323</div></div>
<div class="ttc" id="astructreshade_1_1api_1_1effect__runtime_html"><div class="ttname"><a href="structreshade_1_1api_1_1effect__runtime.html">reshade::api::effect_runtime</a></div><div class="ttdoc">A post-processing effect runtime, used to control effects.</div><div class="ttdef"><b>Definition:</b> reshade_api.hpp:51</div></div>
</div><!-- fragment --><p>Do not call <code>ImGui::Begin</code> and <code>ImGui::End</code> in the callback to create the overlay window itself, ReShade already does this for you before and after calling the callback function. You can however call <code>ImGui::Begin</code> and <code>ImGui::End</code> with a different title to open additional popup windows (this is not recommended though, since those are difficult to navigate in VR).</p>
<p>Overlay names are shared across ReShade and all add-ons, which means you can register with a name already used by ReShade or another add-on to append widgets to their overlay. For example, <code><a class="el" href="namespacereshade.html#ada303de977b98d78a41a898182b54cb0" title="Registers an overlay with ReShade.">reshade::register_overlay</a>("###settings", ...)</code> allows you to add widgets to the settings page in ReShade and <code><a class="el" href="namespacereshade.html#ada303de977b98d78a41a898182b54cb0" title="Registers an overlay with ReShade.">reshade::register_overlay</a>("OSD", ...)</code> allows you to add additional information to the always visible on-screen display (clock, FPS, frametime) ReShade provides. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
